---
const formName = "promo-contact";
---
<form
  class="contact-form"
  name={formName}
  method="POST"
  data-netlify="true"
  data-netlify-honeypot="bot-field"
  action="/submit-quote"
>
  <!-- Netlify hidden fields -->
  <input type="hidden" name="form-name" value={formName} />
  <p class="hidden">
    <label>
      Don’t fill this out if you’re human: <input name="bot-field" />
    </label>
  </p>
  <input type="hidden" name="subject" id="form-subject" value="Winter Promo Submission" />

  <div class="form-row">
    <!-- Full Name & Email -->
    <div class="form-group">
      <label for="name" class="form-label">Full Name *</label>
      <input type="text" id="name" name="name" class="form-input" required placeholder="Enter your full name" />
    </div>

    <div class="form-group">
      <label for="email" class="form-label">Email Address *</label>
      <input type="email" id="email" name="email" class="form-input" required placeholder="your.email@example.com" />
    </div>
  </div>

  <div class="form-row">
    <!-- Phone & Preferred Contact Method -->
    <div class="form-group">
      <label for="phone" class="form-label">Phone Number *</label>
      <input type="tel" id="phone" name="phone" class="form-input" required placeholder="(123) 456-7890" />
    </div>
  </div>

  <div class="form-group">
    <label for="homeowner" class="form-label">Are you an Arizona Home Owner? *</label>
    <select id="homeowner" name="homeowner" class="form-select" required>
      <option value="" disabled selected>Select an option</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <p id="homeowner-message" class="form-message error" style="display: none;">
      We're sorry, you don't qualify for this offer. This promotion is available to Arizona homeowners only.
    </p>
  </div>

  <div class="form-row">
    <!-- Terms Agreement -->
    <div class="form-group">
      <label>
        <input type="checkbox" name="terms" value="Accepted" required />
        I have read and agree to the terms of this special offer.*
        <p>* Special ends on March 31st, 2026. Mini-split size is up to 24000 BTU. There must be room in the electrical panel for the required circuit. Electrical run to mini-split must be less than 30 feet. Any work needed outside of these parameters will not be included in the deal and will require additional fees. Standard water heater installation only, no tankless. Arizona homeowner’s only.</p>
      </label>
    </div>
  </div>

  <div class="form-group full-width">
    <button type="submit" class="button-primary form-submit">Claim My Offer</button>
  </div>
</form>


<style>

.hidden {
    display: none;
}

.form-message.error {
  margin-top: 0.75rem;
  padding: 1rem;
  background-color: #fef2f2;
  border-left: 3px solid #dc2626;
  color: #991b1b;
  font-size: 0.9375rem;
  border-radius: 0 0.25rem 0.25rem 0;
}

/* Form Styles */
.contact-form {
    background: white;
    padding: 3rem;
    border-radius: 0.5rem;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-label {
    color: var(--secondary-500);
    font-weight: 600;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.form-input,
.form-select,
.form-textarea {
    padding: 1rem;
    border: 2px solid var(--primary-200);
    font-family: var(--font-body);
    color: var(--secondary-500);
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    background: white;
    transition: all 0.3s ease-in-out;
}

.form-input:hover,
.form-select:hover,
.form-textarea:hover {
    outline: none;
    border-color: var(--primary-500);
    transition: all 0.3s ease-in-out;
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--primary-500);
    transition: all 0.3s ease-in-out;
}

.form-input[readonly] {
    background-color: #f8fafc;
    color: var(--secondary-500);
}

.form-select {
    cursor: pointer;
}

.form-textarea {
    resize: vertical;
    min-height: 120px;
}

.form-submit {
    width: 100%;
    padding: 1.25rem 2rem;
    font-size: 1.125rem;
    margin-top: 1rem;
    border: none;
    cursor: pointer;
}
</style>

<script is:inline>
  // Dynamic email subject
  document.addEventListener('DOMContentLoaded', () => {
    const nameInput = document.getElementById('name');
    const subjectInput = document.getElementById('form-subject');

    if (nameInput instanceof HTMLInputElement && subjectInput instanceof HTMLInputElement) {
      nameInput.addEventListener('input', () => {
        const name = nameInput.value.trim();
        subjectInput.value = name 
          ? `Winter Promo Submission - ${name}` 
          : 'Winter Promo Submission';
      });
    }
  });

  // Homeowner eligibility message
document.addEventListener('DOMContentLoaded', () => {
  const homeownerSelect = document.getElementById('homeowner');
  const homeownerMessage = document.getElementById('homeowner-message');
  const contactForm = document.querySelector('.contact-form');

  if (homeownerSelect instanceof HTMLSelectElement && homeownerMessage instanceof HTMLElement) {
    homeownerSelect.addEventListener('change', () => {
      if (homeownerSelect.value === 'No') {
        homeownerMessage.style.display = 'block';
      } else {
        homeownerMessage.style.display = 'none';
      }
    });
  }

  if (contactForm instanceof HTMLFormElement && homeownerSelect instanceof HTMLSelectElement && homeownerMessage instanceof HTMLElement) {
    contactForm.addEventListener('submit', (e) => {
      if (homeownerSelect.value === 'No') {
        e.preventDefault();
        homeownerMessage.style.display = 'block';
        homeownerSelect.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });
  }
});
</script>